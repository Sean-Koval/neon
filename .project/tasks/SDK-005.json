{
  "id": "SDK-005",
  "title": "CI mode: JSON output, exit codes, threshold checks",
  "description": "Add CI-specific features to the CLI for automated testing pipelines. This includes machine-readable JSON output, proper exit codes based on test results, and threshold-based pass/fail determination for regression detection.",
  "phase_id": "phase-3-sdk",
  "status": "completed",
  "priority": "high",
  "estimated_hours": 3,
  "dependencies": [
    "SDK-004"
  ],
  "blocks": [],
  "acceptance_criteria": [
    "--json flag outputs results in machine-readable JSON format",
    "--ci flag combines JSON output with non-zero exit code on failure",
    "Exit code 0 when all tests pass thresholds",
    "Exit code 1 when any test fails threshold",
    "--threshold flag sets global pass threshold (default: 0.7)",
    "Per-test threshold override via test definition",
    "JSON output includes: suite name, test results, scores, timing, pass/fail status",
    "JSON schema is documented for CI integration",
    "Works with GitHub Actions (example workflow provided)",
    "Unit tests cover threshold edge cases"
  ],
  "key_files": {
    "primary": [
      "packages/sdk/src/cli/commands/eval.ts",
      "packages/sdk/src/cli/reporters/json-reporter.ts"
    ],
    "new": [
      "packages/sdk/src/cli/reporters/json-reporter.ts",
      "packages/sdk/src/threshold.ts"
    ],
    "tests": [
      "packages/sdk/src/__tests__/cli.test.ts",
      "packages/sdk/src/__tests__/threshold.test.ts"
    ],
    "reference": [
      "packages/sdk/src/cli/reporter.ts",
      "packages/sdk/src/runner.ts"
    ]
  },
  "implementation_notes": [
    "JSON output should be a single line for easy parsing in CI",
    "Consider JUnit XML output as future enhancement",
    "Threshold can be decimal (0.7) or percentage (70%)",
    "Exit codes: 0=pass, 1=fail, 2=error (couldn't run tests)",
    "Support NEON_THRESHOLD env var for CI configuration"
  ],
  "created_at": "2026-01-31T00:00:00Z",
  "started_at": "2026-01-31T12:50:05-05:00",
  "worktree": {
    "branch": "task/SDK-005",
    "path": "/home/seanm/repos/neon-task-SDK-005",
    "created_at": "2026-01-31T12:50:05-05:00"
  }
}
